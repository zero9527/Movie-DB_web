{"version":3,"sources":["webpack:///./src/views/home/home.scss?204b","views/home/home.scss","views/home/index.tsx"],"names":["content","__webpack_require__","module","i","options","hmr","transform","locals","exports","push","home","home-content","block-title","title-item","title-active","nomore","movie-block","movie-item","index","img","movie-title","score","initMovie","title","images","medium","rating","average","initialState","isLoading","currentPage","movieLineStatus","movieLine","movieComing","movieTop250","isTop250FullLoaded","scrTop","Home","_super","props","_this","call","this","state","_onScroll","bind","setTimeout","document","querySelector","style","visibility","Object","tslib__WEBPACK_IMPORTED_MODULE_2__","prototype","componentDidMount","_getMovieLine","_getMovieTop250","_utils__WEBPACK_IMPORTED_MODULE_9__","homeStore","setCount","console","log","count","history","listen","route","onRouteChange","window","addEventListener","componentWillUnmount","setState","removeEventListener","pathname","setScrollTop","includes","top","body","scrollTop","documentElement","winHeight","innerHeight","srcollHeight","scrollHeight","start","location","_api_movie__WEBPACK_IMPORTED_MODULE_4__","city","then","res","subjects","catch","err","antd_mobile_lib_toast__WEBPACK_IMPORTED_MODULE_1___default","a","fail","_getMovieComing","_a","_b","_c","_d","_e","length","movieStatusChange","status","toDetail","id","onConfirm","val","isDetailPage","render","react__WEBPACK_IMPORTED_MODULE_3__","className","_home_scss__WEBPACK_IMPORTED_MODULE_12___default","_components_header_search__WEBPACK_IMPORTED_MODULE_8__","display","onClick","MovieItem","movieList","MovieTop250","_components_loading__WEBPACK_IMPORTED_MODULE_6__","_components_scrollToTop__WEBPACK_IMPORTED_MODULE_7__","children","mobx_react__WEBPACK_IMPORTED_MODULE_11__","map","item","key","src","alt","_components_star__WEBPACK_IMPORTED_MODULE_5__","readonly","__webpack_exports__","react_router__WEBPACK_IMPORTED_MODULE_10__"],"mappings":"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","file":"static/js/5.e8933c34.chunk.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js??ref--5-oneOf-4-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/sass-resources-loader/lib/loader.js??ref--5-oneOf-4-4!./home.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {\"hmr\":true}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js??ref--5-oneOf-4-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/sass-resources-loader/lib/loader.js??ref--5-oneOf-4-4!./home.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js??ref--5-oneOf-4-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/sass-loader/dist/cjs.js!../../../node_modules/sass-resources-loader/lib/loader.js??ref--5-oneOf-4-4!./home.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".home__12hUHQ{width:100%;background-color:#fff}.home__12hUHQ .home-content__3NFRm0{padding-top:80px}.home__12hUHQ .block-title__Ze0JjA{width:100%;margin-bottom:10px;color:#999;font-size:20px}.home__12hUHQ .block-title__Ze0JjA .title-item__1Ahtps{cursor:pointer}.home__12hUHQ .block-title__Ze0JjA .title-item__1Ahtps:nth-of-type(1){margin-right:10px}.home__12hUHQ .block-title__Ze0JjA .title-active__3g2Yqd{color:#2b2b2b;border-bottom:2px solid #2b2b2b}.home__12hUHQ .nomore__q0T1Tp{text-align:center;color:#999}.home__12hUHQ .movie-block__3fEgyc{margin-bottom:20px}.home__12hUHQ .movie-block__3fEgyc .movie-item__3sDKa5{width:calc((100% - 20px) / 3);position:relative;display:inline-block;margin-bottom:16px;-webkit-transition:0.1s ease;-o-transition:0.1s ease;transition:0.1s ease;cursor:pointer}.home__12hUHQ .movie-block__3fEgyc .movie-item__3sDKa5:not(:nth-of-type(3n)){margin-right:10px}.home__12hUHQ .movie-block__3fEgyc .movie-item__3sDKa5:hover img{-webkit-box-shadow:0 1px 10px rgba(50,50,50,0.4);box-shadow:0 1px 10px rgba(50,50,50,0.4)}.home__12hUHQ .movie-block__3fEgyc .movie-item__3sDKa5:active img{-webkit-box-shadow:0 1px 10px rgba(50,50,50,0.4);box-shadow:0 1px 10px rgba(50,50,50,0.4)}.home__12hUHQ .movie-block__3fEgyc .movie-item__3sDKa5 .index__3END5S{position:absolute;top:0;left:0;padding:0 2px;border-radius:4px;color:#fff;font-size:14px;background:rgba(0,0,0,0.5)}.home__12hUHQ .movie-block__3fEgyc .movie-item__3sDKa5 .img__1IJiJt{width:100%;height:150px;display:inline-block;border-radius:4px;overflow:hidden}.home__12hUHQ .movie-block__3fEgyc .movie-item__3sDKa5 .movie-title__1jGat6{margin-top:6px;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden}.home__12hUHQ .movie-block__3fEgyc .movie-item__3sDKa5 .score__EnkDua{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;color:#ccc;line-height:1}.home__12hUHQ .movie-block__3fEgyc .movie-item__3sDKa5 .score__EnkDua>span{margin-left:2px}\\n\", \"\"]);\n\n// exports\nexports.locals = {\n\t\"home\": \"home__12hUHQ\",\n\t\"home-content\": \"home-content__3NFRm0\",\n\t\"block-title\": \"block-title__Ze0JjA\",\n\t\"title-item\": \"title-item__1Ahtps\",\n\t\"title-active\": \"title-active__3g2Yqd\",\n\t\"nomore\": \"nomore__q0T1Tp\",\n\t\"movie-block\": \"movie-block__3fEgyc\",\n\t\"movie-item\": \"movie-item__3sDKa5\",\n\t\"index\": \"index__3END5S\",\n\t\"img\": \"img__1IJiJt\",\n\t\"movie-title\": \"movie-title__1jGat6\",\n\t\"score\": \"score__EnkDua\"\n};","import * as React from 'react';\nimport { getMovieLine, getMovieComing, getMovieTop250 } from '@/api/movie';\nimport Star from '@/components/star';\nimport Loading from '@/components/loading';\nimport TopBtn from '@/components/scrollToTop';\nimport HeaderSearch from '@/components/header-search';\nimport { getMovieTop250All } from '@/utils';\nimport { RouteComponentProps, withRouter } from 'react-router';\nimport { History } from 'history';\nimport { Toast } from 'antd-mobile';\nimport { observer, inject } from 'mobx-react';\nimport { homeStoreType } from '@/store/home';\nimport styles from './home.scss';\n\ninterface IProps extends RouteComponentProps {\n  history: History;\n  homeStore: homeStoreType;\n}\n\n// 占位初始化数据\nconst initMovie: any[] = [\n  { title: '', images: { medium: '' }, rating: { average: '' } },\n  { title: '', images: { medium: '' }, rating: { average: '' } },\n  { title: '', images: { medium: '' }, rating: { average: '' } },\n  { title: '', images: { medium: '' }, rating: { average: '' } },\n  { title: '', images: { medium: '' }, rating: { average: '' } },\n  { title: '', images: { medium: '' }, rating: { average: '' } },\n  { title: '', images: { medium: '' }, rating: { average: '' } },\n  { title: '', images: { medium: '' }, rating: { average: '' } },\n  { title: '', images: { medium: '' }, rating: { average: '' } }\n];\nconst initialState = {\n  isLoading: false,\n  currentPage: 0,\n  movieLineStatus: 0,\n  movieLine: initMovie,\n  movieComing: initMovie,\n  movieTop250: initMovie,\n  isTop250FullLoaded: false,\n  scrTop: 0\n};\n\ntype IState = typeof initialState;\n\n@inject('homeStore')\n@observer\nclass Home extends React.Component<IProps> {\n  public readonly state: Readonly<IState> = initialState;\n\n  constructor(props: IProps) {\n    super(props);\n    this._onScroll = this._onScroll.bind(this);\n    setTimeout(() => {\n      const whiteLoading = document.querySelector(\n        '#white-loading'\n      ) as HTMLDivElement;\n      whiteLoading.style.visibility = 'hidden';\n    }, 1000);\n  }\n\n  public componentDidMount() {\n    this._getMovieLine();\n    this._getMovieTop250();\n    getMovieTop250All();\n\n    this.props.homeStore.setCount(2);\n    console.log(this.props.homeStore.count); // 2\n\n    this.props.history.listen(route => {\n      this.onRouteChange(route);\n    });\n\n    window.addEventListener('scroll', this._onScroll);\n  }\n\n  public componentWillUnmount() {\n    // 组件销毁后，不操作数据\n    this.setState = () => {};\n    window.removeEventListener('scroll', this._onScroll);\n  }\n\n  // 监听路由变化\n  public onRouteChange(route: any) {\n    // 首页\n    if (route.pathname === '/') {\n      const { scrTop } = this.state;\n      window.addEventListener('scroll', this._onScroll);\n      // 恢复滚动条位置\n      this.setScrollTop(scrTop);\n    }\n    // 详情页\n    if (route.pathname.includes('/movie-detail/')) {\n      // 重置滚动条位置\n      this.setScrollTop(0);\n      window.removeEventListener('scroll', this._onScroll);\n    }\n  }\n\n  // 设置滚动条位置\n  public setScrollTop(top: number) {\n    document.body.scrollTop = top;\n    document.documentElement.scrollTop = top;\n  }\n\n  public _onScroll() {\n    const winHeight = window.innerHeight;\n    const srcollHeight = document.documentElement.scrollHeight;\n    const scrollTop =\n      document.body.scrollTop || document.documentElement.scrollTop;\n    const toBottom = srcollHeight - winHeight - scrollTop;\n\n    if (toBottom <= 300) {\n      this._getMovieTop250({ start: this.state.currentPage * 10 });\n    }\n    if (this.props.location.pathname === '/') {\n      this.setState({ scrTop: scrollTop });\n    } else {\n      window.removeEventListener('scroll', this._onScroll);\n    }\n  }\n\n  public _getMovieLine() {\n    if (this.state.movieLine[0].title) return;\n\n    getMovieLine({\n      start: 0,\n      count: 9,\n      city: '深圳'\n    })\n      .then((res: any) => {\n        this.setState({\n          movieLine: res.subjects\n        });\n      })\n      .catch((err: any) => {\n        console.log('err: ', err);\n        Toast.fail('数据加载失败，请稍后再试');\n      });\n  }\n\n  public _getMovieComing() {\n    if (this.state.movieComing[0].title) return;\n\n    getMovieComing({\n      start: 0,\n      count: 9\n    })\n      .then((res: any) => {\n        this.setState({\n          movieComing: res.subjects\n        });\n      })\n      .catch(err => {\n        console.log('err: ', err);\n      });\n  }\n\n  public _getMovieTop250({ start = 0, count = 20 } = {}) {\n    const {\n      isLoading,\n      movieTop250,\n      currentPage,\n      isTop250FullLoaded\n    } = this.state;\n    if (isLoading || isTop250FullLoaded) return;\n\n    this.setState(\n      {\n        isLoading: true\n      },\n      () => {\n        getMovieTop250({\n          start,\n          count\n        })\n          .then((res: any) => {\n            this.setState({\n              movieTop250: movieTop250[0].title\n                ? [...movieTop250, ...res.subjects]\n                : res.subjects,\n              isLoading: false,\n              currentPage: currentPage + 1,\n              isTop250FullLoaded: res.subjects.length === 0\n            });\n          })\n          .catch(err => {\n            console.log('err: ', err);\n            this.setState({ isLoading: false });\n          });\n      }\n    );\n  }\n\n  // 切换院线热播、即将上映\n  public movieStatusChange(status: number) {\n    this.setState({ movieLineStatus: status });\n    const { movieLine, movieComing } = this.state;\n\n    if (status === 0 && !movieLine[0].title) {\n      this._getMovieLine();\n    }\n    if (status === 1 && !movieComing[0].title) {\n      this._getMovieComing();\n    }\n  }\n\n  public toDetail(id: string) {\n    if (!id) return;\n    this.props.history.push(`/movie-detail/${id}`);\n  }\n\n  // 搜索输入框回车\n  public onConfirm(val: string) {\n    if (!val) return;\n    this.props.history.push(`/search?input=${val}`);\n  }\n\n  public isDetailPage() {\n    return this.props.location.pathname.includes('/movie-detail/');\n  }\n\n  public render() {\n    const {\n      movieLineStatus,\n      isLoading,\n      movieLine,\n      movieComing,\n      movieTop250,\n      isTop250FullLoaded\n    } = this.state;\n\n    return (\n      <div className={`${styles.home}`}>\n        {!this.isDetailPage() && (\n          <HeaderSearch onConfirm={val => this.onConfirm(val)} />\n        )}\n        <div\n          className={`${styles['home-content']} center-content`}\n          style={{ display: this.isDetailPage() ? 'none' : 'block' }}\n        >\n          <section className={styles['movie-block']}>\n            <div className={styles['block-title']}>\n              <span\n                className={`${styles['title-item']} ${movieLineStatus === 0 &&\n                  styles['title-active']}`}\n                onClick={() => this.movieStatusChange(0)}\n              >\n                院线热映\n              </span>\n              <span\n                className={`${styles['title-item']} ${movieLineStatus === 1 &&\n                  styles['title-active']}`}\n                onClick={() => this.movieStatusChange(1)}\n              >\n                即将上映\n              </span>\n            </div>\n\n            {movieLineStatus === 0 ? (\n              <MovieItem\n                movieList={movieLine}\n                toDetail={(id: string) => this.toDetail(id)}\n              />\n            ) : (\n              <MovieItem\n                movieList={movieComing}\n                toDetail={(id: string) => this.toDetail(id)}\n              />\n            )}\n          </section>\n\n          <MovieTop250\n            isLoading={isLoading}\n            movieTop250={movieTop250}\n            toDetail={(id: string) => this.toDetail(id)}\n          />\n\n          {isLoading && <Loading />}\n\n          <TopBtn />\n\n          {isTop250FullLoaded && (\n            <div className={styles.nomore}>没有更多数据了~</div>\n          )}\n        </div>\n\n        {/* detial */}\n        {this.props.children}\n      </div>\n    );\n  }\n}\n\nfunction MovieItem({\n  movieList = initMovie,\n  toDetail = (id: string) => {}\n} = {}) {\n  return (\n    <div>\n      {movieList.map((item, index) => (\n        <div\n          className={styles['movie-item']}\n          key={index}\n          title={item.title}\n          onClick={() => toDetail(item.id)}\n        >\n          {!movieList[0].title ? (\n            <div className={`${styles.img} loading-shink`} />\n          ) : (\n            <img\n              className={styles.img}\n              src={item.images.medium}\n              alt=\"loading\"\n            />\n          )}\n          <div className={styles['movie-title']}>{item.title}</div>\n          {item.rating.average === 0 ? (\n            <span className=\"desc\">尚未上映</span>\n          ) : (\n            <div className={styles.score}>\n              <Star score={item.rating.average} readonly={true} />\n              <span>{item.rating.average}</span>\n            </div>\n          )}\n        </div>\n      ))}\n    </div>\n  );\n}\n\nfunction MovieTop250({\n  isLoading = false,\n  movieTop250 = initMovie,\n  toDetail = (id: string) => {}\n} = {}) {\n  return (\n    <section className={styles['movie-block']}>\n      <div className={styles['block-title']}>\n        <span className={styles['title-active']}>Top250</span>\n      </div>\n      <div>\n        {movieTop250.map((item, index) => (\n          <div\n            className={styles['movie-item']}\n            key={index}\n            title={item.title}\n            onClick={() => toDetail(item.id)}\n          >\n            <span className={styles.index}>{index + 1}</span>\n            {isLoading && !movieTop250[0].title ? (\n              <div className={`${styles.img} loading-shink`} />\n            ) : (\n              <img\n                className={styles.img}\n                src={item.images.medium}\n                alt=\"loading\"\n              />\n            )}\n            <div className={styles['movie-title']}>{item.title}</div>\n            <div className={styles.score}>\n              <Star score={item.rating.average} readonly={true} />\n              <span>{item.rating.average}</span>\n            </div>\n          </div>\n        ))}\n      </div>\n    </section>\n  );\n}\n\nexport default withRouter(Home);\n"],"sourceRoot":""}